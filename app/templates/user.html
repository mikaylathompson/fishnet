{% extends "base.html" %}

{% block content %}
<h2 class="subheader">
	{{user.name}}'s fishnet
	{% if user.about_me %}
	<small>
		<br>{{user.about_me}}
	</small>
	{% endif %}
	<small class="really-small">
		{% if user.id == viewer.id %}
			{{viewer.email}}
			<a href="{{url_for('edit', user = g.user.id)}}">Edit</a> 
			<a href="{{ url_for('changepass') }}">Change Password</a>
		{% else %}
			{% with folder = viewer.folders.filter_by(label = 'Connections').first() %}
			{% with address = url_for('user', name = user.name) %}
			{% with connected = folder.links.filter_by(url = address).all() %}
			{% if connected[0] %}
				Connected
			{% else %}
				<a href="{{url_for('connect', userid = user.id)}}">Connect to {{user.name}}</a>
			{% endif %}
			{% endwith %}
			{% endwith %}
			{% endwith %}
		{% endif %}
	</small>
	
</h2>
<!-- {% if user.last_seen %}<em>Last seen on: {{user.last_seen}} </em>{% endif %} -->


{% for folder in sortedLinks.keys() %}
	<fieldset>
	<legend>
		<a href="{{url_for('folder', name=user.name, label=folder.label)}}">{{folder.label}}</a>
	</legend>
	{% for link in sortedLinks[folder] %}
		<h3 class="subheader">
			<a class=link href="{{link.url}}" target="_blank">{{link.title}}</a>
		<small> {{link.annotation}}
			{% if link.user_id == g.user.id %}
			</small><small class="really-small">
				   <a href={{ url_for('editlink', id = link.id) }}>edit</a>
			{% endif %} 
		</small>
		</h3>
	{% endfor %}
	</fieldset>
{% endfor %}
{% endblock %}
